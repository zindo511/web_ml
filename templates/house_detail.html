<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/static/style/house_detail.css">
    <title>Chi ti·∫øt nh√† #{{ house.id }}</title>
</head>

<body>
    <header>
        <h1>Chi ti·∫øt nh√† #{{ house.id }}</h1>
        <div class="user-info">
            <span>Xin ch√†o, <strong>{{ username }}</strong></span>
            <a href="/buyer" class="back-btn">‚Üê Quay l·∫°i danh s√°ch</a>
        </div>
    </header>

    <div class="container">
        <div class="detail-content">
            <!-- Gallery ·∫£nh -->
            <div class="image-gallery">
                <div class="main-image">
                    {% if house.image_path %}
                    <img src="/static/{{ house.image_path }}" alt="Nh√†" id="mainImg">
                    {% else %}
                    <div class="no-image"></div>
                    {% endif %}
                </div>

                {% if house.additional_images %}
                <div class="thumbnail-images">
                    {% if house.image_path %}
                    <img src="/static/{{ house.image_path }}" alt="·∫¢nh ch√≠nh" class="thumbnail active"
                        onclick="changeImage('/static/{{ house.image_path }}')">
                    {% endif %}
                    {% for img_path in house.additional_images %}
                    <img src="/static/{{ img_path }}" alt="·∫¢nh {{ loop.index }}" class="thumbnail"
                        onclick="changeImage('/static/{{ img_path }}')">
                    {% endfor %}
                </div>
                {% endif %}
            </div>

            <!-- Th√¥ng tin nh√† -->
            <div class="house-details">
                <div class="price-box">
                    <div class="main-price">
                        <span class="label">Gi√° b√°n:</span>
                        <span class="value">{{ "{:,.0f}".format(house.seller_price) }}</span>
                    </div>
                    <div class="predicted-price">
                        <span class="label">Gi√° d·ª± ƒëo√°n AI:</span>
                        <span class="value">{{ "{:,.0f}".format(house.predicted_price) }}</span>
                    </div>
                    {% set diff_percent = ((house.seller_price - house.predicted_price) / house.predicted_price * 100) %}
                    {% if diff_percent > 10 %}
                    <div class="price-alert bad">
                        ‚ö†Ô∏è Gi√° cao h∆°n th·ªã tr∆∞·ªùng {{ "{:.1f}".format(diff_percent) }}%
                    </div>
                    {% elif diff_percent < -5 %}
                    <div class="price-alert good">
                        ‚úÖ Deal t·ªët! R·∫ª h∆°n th·ªã tr∆∞·ªùng {{ "{:.1f}".format(-diff_percent) }}%
                    </div>
                    {% else %}
                    <div class="price-alert neutral">
                        ‚úì Gi√° h·ª£p l√Ω
                    </div>
                    {% endif %}
                </div>

                <div class="info-section">
                    <h2>üìã Th√¥ng tin chi ti·∫øt</h2>
                    <div class="info-grid">
                        <div class="info-item">
                            <div>
                                <strong>üè° Di·ªán t√≠ch l√¥ (LotArea):</strong>
                                <p>{{ house.lot_area }} m¬≤</p>
                            </div>
                        </div>
                        <div class="info-item">
                            <div>
                                <strong>üè† Di·ªán t√≠ch s·ªëng (GrLivArea):</strong>
                                <p>{{ house.gr_liv_area }} m¬≤</p>
                            </div>
                        </div>
                        <div class="info-item">
                            <div>
                                <strong>üîΩ Di·ªán t√≠ch t·∫ßng h·∫ßm (TotalBsmtSF):</strong>
                                <p>{{ house.total_bsmt_sf }} m¬≤</p>
                            </div>
                        </div>
                        <div class="info-item">
                            <div>
                                <strong>üìÖ NƒÉm x√¢y d·ª±ng (YearBuilt):</strong>
                                <p>{{ house.year_built }}</p>
                            </div>
                        </div>
                        <div class="info-item">
                            <div>
                                <strong>üîß NƒÉm c·∫£i t·∫°o (YearRemodAdd):</strong>
                                <p>{{ house.year_remod_add }}</p>
                            </div>
                        </div>
                        <div class="info-item">
                            <div>
                                <strong>üöø S·ªë ph√≤ng t·∫Øm (FullBath):</strong>
                                <p>{{ house.full_bath }} ph√≤ng</p>
                            </div>
                        </div>
                        <div class="info-item">
                            <div>
                                <strong>üõèÔ∏è S·ªë ph√≤ng ng·ªß (BedroomAbvGr):</strong>
                                <p>{{ house.bedroom_abv_gr }} ph√≤ng</p>
                            </div>
                        </div>
                        <div class="info-item">
                            <div>
                                <strong>‚≠ê Ch·∫•t l∆∞·ª£ng t·ªïng th·ªÉ (OverallQual):</strong>
                                <p>{{ house.overall_qual }}/10</p>
                            </div>
                        </div>
                        <div class="info-item">
                            <div>
                                <strong>üîç T√¨nh tr·∫°ng t·ªïng th·ªÉ (OverallCond):</strong>
                                <p>{{ house.overall_cond }}/10</p>
                            </div>
                        </div>
                        <div class="info-item">
                            <div>
                                <strong>üöó S·ªë ch·ªó ƒë·ªó xe (GarageCars):</strong>
                                <p>{{ house.garage_cars }} xe</p>
                            </div>
                        </div>
                    </div>
                </div>

                {% if house.description %}
                <div class="description-section">
                    <h2>üìù M√¥ t·∫£</h2>
                    <p>{{ house.description }}</p>
                </div>
                {% endif %}

                <div class="seller-section">
                    <h2>üë§ Th√¥ng tin ng∆∞·ªùi b√°n</h2>
                    <div class="seller-info">
                        <div class="seller-avatar">{{ house.seller_username[0].upper() }}</div>
                        <div>
                            <p><strong>Ng∆∞·ªùi b√°n:</strong> {{ house.seller_username }}</p>
                            <p><strong>Ng√†y ƒëƒÉng:</strong> {{ house.created_at[:10] if house.created_at else 'N/A' }}</p>
                            <p><strong>Tr·∫°ng th√°i:</strong>
                                {% if house.status == 'available' %}
                                <span class="status-badge available">ƒêang b√°n</span>
                                {% else %}
                                <span class="status-badge sold">ƒê√£ b√°n</span>
                                {% endif %}
                            </p>
                        </div>
                    </div>
                </div>

                {% if house.status == 'available' %}
                <div class="action-section">
                    <a href="/payment/{{ house.id }}" class="buy-now-btn">üí≥ Mua ngay</a>
                </div>
                {% endif %}
            </div>
        </div>
    </div>

    <script>
        function changeImage(src) {
            document.getElementById('mainImg').src = src;
            document.querySelectorAll('.thumbnail').forEach(t => t.classList.remove('active'));
            event.target.classList.add('active');
        }
    </script>
</body>

</html>